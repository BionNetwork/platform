{% extends "etl/datasources/index.html" %}

{% load staticfiles i18n %}

{% block content-header %}
    <h1>
        Редактирование куба
    </h1>
{% endblock %}

{% block css %}
    <link href="{% static 'css/sources.css' %}" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="row">
    <div class="col-lg-12">
        <div class="box box-warning">
            <ul class="nav nav-tabs">
                <li class="active"><a href="#source" data-toggle="tab">
                        <div class="box-header with-border">
                            <h3 class="box-title">Куб</h3>
                        </div>
                    </a>
                </li>
            </ul>
            <form novalidate role="form" method="post" id="conn_form">
                <div class="box-body">

                    <!-- /.box-header -->
                    <div class="col-md-6">

                        {% csrf_token %}

                        <div class="form-group">
                            <label>Название</label>
                                <div>
                                    <input class="form-control" maxlength="255" name="name" required="true" type="text" value="{{cube.name}}"/>
                                </div>
                        </div>

                        <div class="form-group">
                            <label>Меры</label>
                                <ol>
                                    {% for meas in measures %}
                                        <li>{{ meas.name }} ({{ meas.title }}) - {{ meas.type }}</li>
                                    {% endfor %}
                                </ol>
                        </div>

                        <div class="form-group">
                            <label>Измерения</label>
                                <ol>
                                    {% for dim in dimensions %}
                                        <li>{{ dim.name }} ({{ dim.title }}) - {{ dim.type }}</li>
                                    {% endfor %}
                                </ol>
                        </div>

                        <div class="form-group">
                            <button type="button" class="btn btn-default">Перегенерировать</button>
                            <button type="submit" class="btn btn-success">Сохранить</button>
                            <a class="btn btn-danger" href="{% url "etl:cubes.index" %}">Отмена</a>
                        </div>
                    </div>
                    <!-- /.box-body -->
                    <div class="col-md-6">
                         <div class="form-group col-md-offset-1">
                            <label style="margin-left:10px">Данные</label>
                                <div>
                                    <button type="button" class="btn btn-sm btn-warning"
                                        onclick="getConnectionDataOnCube(
                                        {{cube.id}}, {{source_id}},
                                        '{% url "etl:cubes.update_cube_tree" %}',
                                        '{% url "etl:datasources.get_data" source_id %}',
                                        '{% url "etl:datasources.remove_all_tables" %}'
                                        )">Просмотр</button>
                                </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock content %}


{% block javascript %}
    <script src="{% static 'js/sources.js' %}"></script>
    <script src="{% static 'js/cubes.js' %}"></script>
{% endblock javascript %}
