!function(){"use strict";angular.module("BIPlatform",["ui.router"])}(),function(){"use strict";function e(e,t){e.state("not-found",{url:"/not-found",template:"not found"}).state("home",{url:"/",templateUrl:"/assets/angular/main/mainTmpl.html",controller:"mainCtrl"}),t.otherwise(function(e,t){return""===t.path()?"/":void 0})}angular.module("BIPlatform").config(["$stateProvider","$urlRouterProvider",e])}(),function(){"use strict";function e(e){}angular.module("BIPlatform").controller("mainCtrl",["$scope",e])}(),function(){"use strict";function e(e){e.homeRef=e.homeRef||"home"}angular.module("BIPlatform").controller("logoController",["$scope",e])}(),function(){"use strict";function e(){return{restrict:"E",scope:{homeRef:"="},controller:"logoController",templateUrl:"/assets/angular/shared/logo/logoTmpl.html"}}angular.module("BIPlatform").directive("logo",e)}(),function(){"use strict";function e(e){}angular.module("BIPlatform").controller("menuController",["$scope",e])}(),function(){"use strict";function e(){return{restrict:"E",scope:{},controller:"menuController",templateUrl:"/assets/angular/shared/menu/menuTmpl.html"}}angular.module("BIPlatform").directive("menu",e)}(),function(){"use strict";function e(e,t){e.state("etl.add",{url:"/add",controller:"etlFormController",templateUrl:"/assets/angular/components/etl/form/etlFormTmpl.html"}).state("etl.edit",{url:"/edit/:id",controller:"etlFormController",templateUrl:"/assets/angular/components/etl/form/etlFormTmpl.html"})}angular.module("BIPlatform").config(["$stateProvider","$urlRouterProvider",e])}(),function(){"use strict";function e(e,t,r){function o(t){e.etl=t}function n(e){t.go("etl.view")}function l(e){t.go("etl.view")}function a(e){console.log("error",e)}e.etl={},t.params.id&&r.read({id:t.params.id}).then(o,a),e.submit=function(e){e.id?r.update(e).then(l,a):r.add(e).then(n,a)}}angular.module("BIPlatform").controller("etlFormController",["$scope","$state","$etlHTTP",e])}(),function(){"use strict";function e(e,t){e.state("etl.graph",{url:"/graph/:data",controller:"etlGraphController",templateUrl:"/assets/angular/components/etl/graph/etlGraphTmpl.html"})}angular.module("BIPlatform").config(["$stateProvider","$urlRouterProvider",e])}(),function(){"use strict";function e(e,t,r){function o(){var t={top:20,right:20,bottom:30,left:50},r=960-t.left-t.right,o=500-t.top-t.bottom,n=(d3.time.format("%d-%b-%y"),d3.time.scale().range([0,r])),l=d3.scale.linear().range([o,0]),s=d3.svg.axis().scale(n).orient("bottom"),u=d3.svg.axis().scale(l).orient("left"),i=new Range;i.selectNodeContents(document.getElementById("area57")),i.deleteContents();var c=d3.svg.line().x(function(t){return n(t[e.selectedRow])}).y(function(t){return l(t[e.selectedColumn])}),m=d3.select("#area57").append("svg").attr("width",r+t.left+t.right).attr("height",o+t.top+t.bottom).append("g").attr("transform","translate("+t.left+","+t.top+")");n.domain(d3.extent(a,function(t){return t[e.selectedRow]})),l.domain(d3.extent(a,function(t){return t[e.selectedColumn]})),m.append("g").attr("class","x axis").attr("transform","translate(0,"+o+")").call(s),m.append("g").attr("class","y axis").call(u).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end").text("Price ($)"),m.append("path").datum(a).attr("class","line").attr("d",c)}function n(e){a=e.data.data}function l(e){console.log("reason",e)}var a,s=JSON.parse(t.params.data),u=JSON.parse(s.colsInfo.cols);e.columns=u,r.requestContent(s).then(n,l),e.doRender=function(){o()},e.selectedRow=void 0,e.selectedColumn=void 0}angular.module("BIPlatform").controller("etlGraphController",["$scope","$state","$etlGraphHTTP",e])}(),function(){"use strict";function e(e,t){this.requestContent=function(t){var r=JSON.parse(JSON.stringify(t.colsInfo));return e.post(t.url,r,{transformRequest:function(e){var t=[];for(var r in e)t.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t.join("&")},headers:{"X-CSRFToken":csrftoken,"Content-Type":"application/x-www-form-urlencoded"}})}}angular.module("BIPlatform").service("$etlGraphHTTP",["$http","$q",e])}(),function(){"use strict";function e(e,t){e.state("etl.manage",{url:"/manage/:id",controller:"etlManageController",templateUrl:"/assets/angular/components/etl/manage/etlManageTmpl.html"})}angular.module("BIPlatform").config(["$stateProvider","$urlRouterProvider",e])}(),function(){"use strict";function e(e,t,r){var o=t.params.id;e.getRequest_RefreshData=function(){t.go("etl.graph",{data:JSON.stringify(window.refreshData_request)})},getConnectionData("/etl/datasources/get_data/"+o+"/","/etl/datasources/remove_all_tables/")}angular.module("BIPlatform").controller("etlManageController",["$scope","$state","$etlManageHTTP",e])}(),function(){"use strict";function e(e,t){}angular.module("BIPlatform").service("$etlManageHTTP",["$http","$q",e])}(),function(){"use strict";function e(e,t){e.state("etl.view",{url:"/view",controller:"etlViewController",templateUrl:"/assets/angular/components/etl/view/etlViewTmpl.html"})}angular.module("BIPlatform").config(["$stateProvider","$urlRouterProvider",e])}(),function(){"use strict";function e(e,t){function r(t){e.etls=t}function o(t){var r,o=e.etls,n=o.length,l=!1;for(r=0;n>r;r++)if(o[r].id==t.id){l=!0,o.splice(r,1);break}l?$("#etlRemoveModal").modal("hide"):console.log("Something went wrong...")}function n(e){console.log("error",e)}e.etls=[],e.currentEtl=void 0,t.read().then(r,n),e.confirmRemove=function(){t.remove(e.currentEtl).then(o,n)},e.cancelRemove=function(){console.log("cancelRemove item",e.currentEtl)},e.prepareRemove=function(t){e.currentEtl=t}}angular.module("BIPlatform").controller("etlViewController",["$scope","$etlHTTP",e])}(),function(){"use strict";function e(e,t){e.state("users.add",{url:"/add",controller:"usersFormController",templateUrl:"/assets/angular/components/users/form/usersFormTmpl.html"}).state("users.edit",{url:"/edit/:id",controller:"usersFormController",templateUrl:"/assets/angular/components/users/form/usersFormTmpl.html"})}angular.module("BIPlatform").config(["$stateProvider","$urlRouterProvider",e])}(),function(){"use strict";function e(e,t,r){function o(t){e.user=t}function n(e){t.go("users.view")}function l(e){t.go("users.view")}function a(e){console.log("error",e)}e.user={status:"active"},t.params.id&&r.read({id:t.params.id}).then(o,a),e.submit=function(e){e.id?r.update(e).then(l,a):r.add(e).then(n,a)}}angular.module("BIPlatform").controller("usersFormController",["$scope","$state","$usersHTTP",e])}(),function(){"use strict";function e(e,t){e.state("users.view",{url:"/view",controller:"usersViewController",templateUrl:"/assets/angular/components/users/view/usersViewTmpl.html"})}angular.module("BIPlatform").config(["$stateProvider","$urlRouterProvider",e])}(),function(){"use strict";function e(e,t){function r(t){e.users=t}function o(t){var r,o=e.users,n=o.length,l=!1;for(r=0;n>r;r++)if(o[r].id==t.id){l=!0,o.splice(r,1);break}l?$("#userRemoveModal").modal("hide"):console.log("Something went wrong...")}function n(e){console.log("error",e)}e.users=[],e.currentUser=void 0,t.read().then(r,n),e.confirmRemove=function(){t.remove(e.currentUser).then(o,n)},e.cancelRemove=function(){console.log("cancelRemove item",e.currentUser)},e.prepareRemove=function(t){e.currentUser=t}}angular.module("BIPlatform").controller("usersViewController",["$scope","$usersHTTP",e])}(),function(){"use strict";function e(e,t){e.state("etl",{"abstract":!0,url:"/etl",controller:"etlController",templateUrl:"/assets/angular/components/etl/etlTmpl.html"})}angular.module("BIPlatform").config(["$stateProvider","$urlRouterProvider",e])}(),function(){"use strict";function e(e){}angular.module("BIPlatform").controller("etlController",["$scope",e])}(),function(){"use strict";function e(e,t){var r=[];this.add=function(e){var o=t.defer();return e.id=r.length+1,r.push(e),o.resolve(e),o.promise},this.update=function(e){var o,n=t.defer(),l=!1,a=r.length;if(!e)return n.reject({message:"no etl to update was provided"}),n.promise;if(!e.id)return n.reject({message:"incorrect etl - has not id"}),n.promise;for(o=0;a>o;o++)if(r[o].id==e.id){l=!0,r[o]=e,n.resolve(JSON.parse(JSON.stringify(r[o])));break}return l||n.reject({message:"cannot update"}),n.promise},this.read=function(o){var n,l,a=t.defer(),s=r.length;if(!o)return e.get("/etl/api/datasources/").then(function(e){return r=e.data.data});if(o.id){for(n=!1,l=0;s>l;l++)if(r[l].id==o.id){n=!0,a.resolve(JSON.parse(JSON.stringify(r[l])));break}n||a.reject({message:"cannot read"})}return a.promise},this.remove=function(e){var o,n=t.defer(),l=!1,a=r.length;if(!e)return n.reject({message:"no etl to update was provided"}),n.promise;if(!e.id)return n.reject({message:"incorrect etl - has not id"}),n.promise;for(o=0;a>o;o++)if(r[o].id==e.id){l=!0,r.splice(o,1),n.resolve(JSON.parse(JSON.stringify(e)));break}return l||n.reject({message:"cannot delete"}),n.promise}}angular.module("BIPlatform").service("$etlHTTP",["$http","$q",e])}(),function(){"use strict";function e(e,t){e.state("users",{"abstract":!0,url:"/users",controller:"usersController",templateUrl:"/assets/angular/components/users/usersTmpl.html"})}angular.module("BIPlatform").config(["$stateProvider","$urlRouterProvider",e])}(),function(){"use strict";function e(e){}angular.module("BIPlatform").controller("usersController",["$scope",e])}(),function(){"use strict";function e(e,n){this.add=function(r){var o=t,n={url:o,data:r,headers:{"X-CSRFToken":csrftoken},method:"POST"};return e(n).then(function(e){return e.data})},this.update=function(t){var o=n.defer(),l=r;if(!t)return o.reject({message:"no user to update was provided"}),o.promise;if(!t.id)return o.reject({message:"incorrect user - has not id"}),o.promise;l+=t.id;var a={url:l,data:t,headers:{"X-CSRFToken":csrftoken},method:"PATCH"};return e(a).then(function(e){return e.data})},this.read=function(r){var o=t;r&&r.id&&(o+=r.id);var n={url:o,headers:{"X-CSRFToken":csrftoken},method:"GET"};return e(n).then(function(e){return e.data})},this.remove=function(t){var r=n.defer(),l=o;if(!t)return r.reject({message:"no user to update was provided"}),r.promise;if(!t.id)return r.reject({message:"incorrect user - has not id"}),r.promise;l+=t.id;var a={url:l,data:t,headers:{"X-CSRFToken":csrftoken},method:"DELETE"};return e(a).then(function(e){return t})}}angular.module("BIPlatform").service("$usersHTTP",["$http","$q",e]);var t="/api/v1/users/",r=t,o=t}();